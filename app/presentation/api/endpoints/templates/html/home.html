<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç–∞—Ç—å–∏</title>
    <link rel="stylesheet" href="/static/css/home.css">
<script src="https://kit.fontawesome.com/cb8c9c5d8f.js" crossorigin="anonymous"></script></head>
<body>
    <button class="menu-icon">
        <i class="fa-solid fa-align-justify"></i>
    </button>
    <div class='menu-items'>  
        <a href="/articles/submit" class="item-menu">
            –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞—Ç—å—é
        </a>
        <a href="/user/articles" class="item-menu">
            –ú–æ–∏ —Å—Ç–∞—Ç—å–∏
        </a>
        <a href="/user/profile" class="item-menu">
            –ü—Ä–æ—Ñ–∏–ª—å
        </a>
        <a href="/exit"  class="item-menu">
            –í—ã—Ö–æ–¥
        </a>
        <a href="/articles/categories"  class="item-menu">
            –í—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
        </a>
        {% if login %}
            <a href="/register" class="item-menu">
                –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
            </a>
            <a href="/login" class="item-menu">
                –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
            </a>
        {% endif %}  
    </div>
    <!-- –ù–û–í–´–ô –ö–û–î: –†–∞—Å–∫—Ä—ã–≤–∞—é—â–∏–π—Å—è –ø–æ–∏—Å–∫ -->
    <div class="search-container">
        <form action="/articles/search" method="get" class="search-form-wrapper">
            <div class="search-wrapper" id="searchWrapper">
                <input 
                    type="text" 
                    name="query" 
                    class="search-input" 
                    id="searchInput"
                    placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..."
                >
                <button type="button" class="search-icon-btn" id="searchToggle">
                    üîç
                </button>
            </div>
        </form>
    </div>

<div class="container">
    {% if articles %}
        {% for article in articles %}
        <div class="article-card">
            <div class="article-header">
                <h2 class="article-title">{{ article.title }}</h2>
                <div class="article-meta">
                    <div class="meta-item">
                        <span class="date">{{ article.created_at.strftime('%d.%m.%Y %H:%M') }}</span>
                    </div>
                    <div class="meta-item">
                        <span class="author">{{ article.nickname }}</span>
                    </div>
                    <div class="meta-item">
                        <span class="category">{{ article.category }}</span>
                    </div>
                </div>
            </div>
            
            <div class="article-content">
                <p>{{ article.content[0:200] }}...
                    <a href="/article/{{ article.id }}" class="read-more">
                        –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
                    </a>
                </p>
            </div>
        </div>
        {% endfor %}
    {% endif %}
</div>
    <script>
        const menuItems = document.querySelector('.menu-items')
        const menuButton = document.querySelector('.menu-icon')
        const searchWrapper = document.querySelector('.search-wrapper')
        const searchToggle = document.querySelector('#searchToggle')
        const searchInput = document.querySelector('#searchInput')
        const searchButtonSubmit = document.querySelector('.search-submit-btn')

        menuButton.addEventListener('click', () => {
            // e.stopPropagation();
            menuItems.classList.add('active')
        })

        document.addEventListener('click', (e) => {
            if (!menuItems.contains(e.target) && !menuButton.contains(e.target)) {
                menuItems.classList.remove('active')
            }
        })

        searchToggle.addEventListener('click', function() {
            if (searchInput.classList.contains('active')) {
                this.closest('form').submit();
            } else {
                searchInput.classList.add('active');
                searchInput.focus()
            }
        })

        document.addEventListener('click', (e) => {
            if (!searchWrapper.contains(e.target)) {
                searchInput.classList.remove('active')
            }
        })


    </script>
</body>
</html>